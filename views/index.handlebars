<div class="container" id="content">
    <div class="row d-flex justify-content-center">
        <div id="main-content" class="col-offset-3 col-6">
            <div class="col-12 text-center">
                <h1 class="display-4" id="title">Burgers</h1>
            </div>
            <hr>
            <form class="new-burger">
                <div class="form-group">
                    <label for="burgerSearch">Add Your Favorite Burger</label>
                    <input type="text" name="burger" class="form-control" id="burger-input" placeholder="Baconator">
                </div>
                <button type="submit" class="btn btn-primary">Submit</button>
            </form>
            <br>
            <div class="row">
                <div class="col">
                    <h5 class="text-center">Would You Like to Devoure?</h5>
                    <ul class="list-group">
                        {{#each burgers}}
                            {{#unless devoured}}
                                <li class="list-group-item">{{id}}. {{burger_name}}</li>
                                <button type="button" class="btn btn-secondary devoured-btn" data-id="{{id}}">Devoure!</button>
                                <br>
                            {{/unless}}
                        {{/each}}
                    </ul>
                </div>
                <div class="col">
                    <h5 class="text-center">Previously Enjoyed:</h5>
                    <ul class="list-group">
                        {{#each burgers}}
                            {{#if devoured}}
                                <li class="list-group-item">{{id}}. {{burger_name}}</li>
                            {{/if}}
                        {{/each}}
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    $(".new-burger").on("submit", function (event) {
        // Make sure to preventDefault on a submit event.
        event.preventDefault();
        var newBurger = {
            burger_name: $("#burger-input").val().trim(),
            devoured: 0
        };
        // Send the POST request.
        $.post("/api/burgers", newBurger)
            .then(
                function () {
                    console.log("created new burger");
                    // Reload the page to get the updated list
                    location.reload();
                }
            );
    });

        $(".devoured-btn").on("click", function (event) {
            var id = $(this).data("id");
            var newDevoured = 1;
            {{!-- console.log(id);
            console.log(newDevoured); --}}

            var newDevouredSate = {
                devoured: newDevoured
            }

            $.ajax(`/api/burgers/${id}`, {
                type: "PUT",
                data: newDevouredSate
            }).then(
                function(){
                    console.log(`changed sleep to ${newDevoured}`)
                    location.reload();
                }
            )
        });


</script>